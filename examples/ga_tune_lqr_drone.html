<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Using GA to Tune The LQR Drone &mdash; jdrones 0.9.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=39bb1c6d"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "macros": {"vec": ["{\\mathbf #1}", 1], "m": "\\text{m}", "ms": "\\text{m}\\text{s}^-1", "mss": "\\text{m}\\text{s}^-2"}}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Linearise Nonlinear Model Automatically" href="linearise_nonlinear_model.html" />
    <link rel="prev" title="Simple Position" href="simple_position.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            jdrones
              <img src="../_static/banner_nobg.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.9.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../readme.html">Why</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readme.html#environments">Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readme.html#development">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readme.html#citations">Citations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readme.html#future-work">Future Work</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="examples.html">Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html#simple-examples">Simple Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="examples.html#automation">Automation</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Using GA to Tune The LQR Drone</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#GA">GA</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="linearise_nonlinear_model.html">Linearise Nonlinear Model Automatically</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html#experimental-control">Experimental Control</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../envs.html">Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_models.html">Data Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controllers.html">Controllers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory.html">Trajectory Generation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc.</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Contributors</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">jdrones</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="examples.html">Validation</a></li>
      <li class="breadcrumb-item active">Using GA to Tune The LQR Drone</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/ga_tune_lqr_drone.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Using-GA-to-Tune-The-LQR-Drone">
<h1>Using GA to Tune The LQR Drone<a class="headerlink" href="#Using-GA-to-Tune-The-LQR-Drone" title="Link to this heading">ÔÉÅ</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>!pip install -q deap
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from deap import algorithms, base, benchmarks, creator, tools
from deap.benchmarks.tools import diversity, convergence, hypervolume
import array, random, json
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from notebook_quick_setup import *
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Beginning notebook setup...
        Added /home/jhewers/Repositories/jdrones/src to path
        Imported gymnasium version 0.29.1
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
pybullet build time: Nov 27 2023 15:36:15
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
        Imported jdrones version 0.7.3.dev80+g6a8b455.d20240322
        Imported scipy==1.11.4, numpy==1.26.2, pandas==2.1.3
        Imported functools, collections and itertools
        Imported tqdm (standard and trange)
        Imported seaborn==0.13.0, matplotlib==3.8.2
End of notebook setup
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def J(obs, u):
    x = np.zeros((obs.shape[0], 20))
    x[:,[0,1,2,10,11,12,7,8,9,13,14,15]] = u
    l1norm = np.linalg.norm(x - obs,axis=0)
    return l1norm @ np.array(
        [0,0,25, # x y z
         0,0,0,0, # Q1 - Q4
         1,1,1, # R P Y
         25,25,0, # vx vy vz
         1,1,1, # P Q R
         0,0,0,0 # P1 - P4
        ]
    )
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def simulate(env, u, progress=False):
    dq = collections.deque()
    obs, _ = env.reset()

    if progress:
        it = tqdm(u)
    else:
        it = u

    for ui in it:
        if np.any(np.isnan(obs)):
            obs[np.isnan(obs)] = np.inf
            dq.append(np.copy(obs))
            break

        dq.append(np.copy(obs))
        obs, *_ = env.step(ui)

    return States(dq)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def get_drone(Q,R, dt):
    initial_state = State()
    initial_state.pos = (1,1,0.1)
    initial_state.rpy = (0,0,0.3)
    initial_state.prop_omega = np.ones(4)*6
    return gymnasium.make(&quot;LQRDroneEnv-v0&quot;, Q=Q,R=R, dt=dt, initial_state=initial_state)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def individual_to_Q_R(individual):
    return np.diag(individual[:12]), np.diag(individual[12:])
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def cost(individual, dt, u, progress=False):
    Q,R = individual_to_Q_R(individual)

    # Check if matrix is singular
    if any(~np.isfinite(np.linalg.cond(f)) for f in (Q,R)):
        return 1e9
    try:
        env = get_drone(Q,R, dt)
    except scipy.linalg.LinAlgError:
        return 1e9
    obs = simulate(env, u, progress=progress)
    return J(obs, u)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>T = 5
dt = 1/100
_u  = State()
_u.vel = [2.5,2.5,0]
_u.rpy = [0,0,0]
u = np.repeat(_u.to_x()[None,:],int(T/dt),axis=0)

CXPB, MUTPB = 0.55, 0.05
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>Q = np.array([1, 1, 1, 50, 50, 10, 100, 100, 10, 1, 1, 1]) * 1e-6
R = np.array([10, 10, 100, 0.001])
benchmark = cost(np.concatenate([Q,R]), dt, u)
benchmark
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2086.613390465199
</pre></div></div>
</div>
<section id="GA">
<h2>GA<a class="headerlink" href="#GA" title="Link to this heading">ÔÉÅ</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>creator.create(&quot;FitnessMin&quot;, base.Fitness, weights=(-1,))
creator.create(&quot;Individual&quot;, list, fitness=creator.FitnessMin)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>toolbox = base.Toolbox()
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import multiprocessing

pool = multiprocessing.Pool(28)
toolbox.register(&quot;map&quot;, pool.map)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>BOUND_LOW = np.array((1e-6,) * 12 + (1,) * 3 + (0,))
BOUND_HIGH = np.array((1e-4,) * 12 + (100,) * 3 + (1e-3,))
SCALE=np.array((1e-5,)*12+(1,)*4)
NDIM = 16
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def mutNGaus(indiviudal,scale, N, indpb):
    p = indpb * np.ones(len(indiviudal))
    inds = np.random.choice(np.arange(0,len(indiviudal)),p=p/p.sum(),size=N)

    for i in inds:
        indiviudal[i] = np.clip(indiviudal[i] + np.random.normal(scale=scale[i]),0,np.inf)

    return indiviudal
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>toolbox.register(&quot;attr_float&quot;, np.random.uniform, BOUND_LOW, BOUND_HIGH, NDIM)
toolbox.register(&quot;individual&quot;, tools.initIterate, creator.Individual, toolbox.attr_float)
toolbox.register(&quot;population&quot;, tools.initRepeat, list, toolbox.individual)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>toolbox.register(&quot;evaluate&quot;, cost,dt=dt,u=u)
toolbox.register(&quot;mate&quot;, tools.cxOnePoint)
toolbox.register(&quot;mutate&quot;, mutNGaus, scale=SCALE,N=1, indpb=1/NDIM)
toolbox.register(&quot;select&quot;, tools.selTournament, tournsize=3)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def get_pop(n=50):
    pop = toolbox.population(n=n)
    return pop
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def get_stats():
    stats = tools.Statistics(lambda ind: ind.fitness.values)
    stats.register(&quot;avg&quot;, np.mean)
    stats.register(&quot;std&quot;, np.std)
    stats.register(&quot;min&quot;, np.min)
    stats.register(&quot;max&quot;, np.max)
    return stats
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def get_logbook(stats):
    logbook = tools.Logbook()
    logbook.header = [&quot;gen&quot;, &quot;evals&quot;] + stats.fields
    return logbook
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def get_hof(n=5):
     return tools.HallOfFame(n)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>stats = get_stats()
pop = get_pop()

if &#39;logbook&#39; not in globals():
    logbook = get_logbook(stats)
    start_gen = 0
else:
    start_gen = max(logbook, key= lambda v: v[&#39;gen&#39;])[&#39;gen&#39;]+1
    print(f&quot;Old logbook and population found, starting from {start_gen}&quot;)

if &#39;hof&#39; in globals():
    for i,ind in enumerate(hof):
        pop[i] = ind
else:
    hof = get_hof()

for ind, fit in zip(pop, toolbox.map(toolbox.evaluate, pop)):
    ind.fitness.values = (fit,)
fits = [ind.fitness.values[0] for ind in pop]

progress = trange(start_gen,5000+start_gen)
for i in progress:
    hof.update(pop)

    compiled = stats.compile(pop)
    logbook.record(gen=i, evals=len(pop), **compiled)
    progress.set_description(f&quot;({i}) Rel. imp. = {benchmark-hof[0].fitness.values[0]:.2f} | Best: {hof[0].fitness.values[0]:.2f} | Avg: {compiled[&#39;avg&#39;]:.2f} | Std: {compiled[&#39;std&#39;]:.2f}&quot;)

    offspring = toolbox.select(pop, len(pop))
    offspring = list(toolbox.map(toolbox.clone, offspring))

    for child1, child2 in zip(offspring[::2], offspring[1::2]):
        if random.random() &lt; CXPB:
            toolbox.mate(child1, child2)
            del child1.fitness.values
            del child2.fitness.values

    for mutant in offspring:
        if random.random() &lt; MUTPB:
            toolbox.mutate(mutant)
            del mutant.fitness.values

    invalid_ind = [ind for ind in offspring if not ind.fitness.valid]
    fitnesses = toolbox.map(toolbox.evaluate, invalid_ind)
    for ind, fit in zip(invalid_ind, fitnesses):
        ind.fitness.values = (fit,)
    pop[:] = offspring

    fits = [ind.fitness.values[0] for ind in pop]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "02c0f7fce73748dea7914a30f2464f31", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>stats = pd.DataFrame(logbook)
stats.set_index(&quot;gen&quot;, inplace=True)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, ax = plt.subplots()
sns.lineplot(data=stats,x=&#39;gen&#39;,y=&#39;min&#39;,ax=ax)
plt.show()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_ga_tune_lqr_drone_25_0.png" src="../_images/examples_ga_tune_lqr_drone_25_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>hof[0]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[4.6176861297742446e-08,
 8.20079210554526e-09,
 0.002015319613213222,
 0.0019725098771573558,
 0.0019729667280019856,
 0.0017448932320868343,
 0.00038948848401190175,
 6.60213968465527e-08,
 0.0013440112213180333,
 0.0002558222985053156,
 7.213974171712665e-08,
 2.2824520808018255e-07,
 0.004613030294333662,
 0.005277238690122938,
 0.003479685903363842,
 0.0004249097075205608]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>df = pd.concat(
    [
        simulate(
            get_drone(*individual_to_Q_R(f), dt),
            u,
        ).to_df(tag=t, dt=dt)
        for t, f in [[&quot;1st GA&quot;, hof[0]], [&quot;Hand Tuned&quot;, np.concatenate([Q,R])], [&quot;Random&quot;, toolbox.individual()]]
    ]
).reset_index()
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, ax = plt.subplots(3, figsize=(10, 8))
ax = ax.flatten()
for i, vars in enumerate(
    [&quot;&#39;x&#39;,&#39;y&#39;,&#39;z&#39;&quot;,&quot;&#39;vx&#39;,&#39;vy&#39;,&#39;vz&#39;&quot;, &quot;&#39;phi&#39;,&#39;theta&#39;,&#39;psi&#39;&quot;]
):
    sns.lineplot(
        data=df.query(f&quot;variable in ({vars})&quot;),
        x=&quot;t&quot;,
        y=&quot;value&quot;,
        hue=&quot;variable&quot;,
        style=&quot;tag&quot;,
        ax=ax[i],
    )
    ax[i].legend()
fig.tight_layout()
plt.show()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_ga_tune_lqr_drone_28_0.png" src="../_images/examples_ga_tune_lqr_drone_28_0.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="simple_position.html" class="btn btn-neutral float-left" title="Simple Position" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="linearise_nonlinear_model.html" class="btn btn-neutral float-right" title="Linearise Nonlinear Model Automatically" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Jan-Hendrik Ewers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>